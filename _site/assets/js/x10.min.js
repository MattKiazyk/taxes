/* 
 * x10.js v0.1.3 
 * Web worker wrapper with simple interface 
 * 
 * Copyright (c) 2013-2015, Hakan Bilgin <hbi@longscript.com> 
 * Licensed under the MIT License 
 */ 
!function(a,b){var c={init:function(){return this},work_handler:function(a){var b=Array.prototype.slice.call(a.data,1),c=a.data[0],d=tree[c].apply(tree,b);postMessage([c,d])},setup:function(b){var d=a.URL||a.webkitURL,e="var tree = {"+this.parse(b).join(",")+"};",f=new Blob([e+'self.addEventListener("message", '+this.work_handler.toString()+", false);"],{type:"text/javascript"}),g=new Worker(d.createObjectURL(f));return g.onmessage=function(a){var b=Array.prototype.slice.call(a.data,1),d=a.data[0];c.observer.emit("x10:"+d,b)},g},call_handler:function(a,b){return function(){var d=Array.prototype.slice.call(arguments,0,-1),e=arguments[arguments.length-1];d.unshift(a),c.observer.on("x10:"+a,function(a){e(a.detail[0])}),b.postMessage(d)}},compile:function(a){var b,c=this.setup("function"==typeof a?{func:a}:a),d={};if("function"==typeof a)return d.func=this.call_handler("func",c),d.func;for(b in a)d[b]=this.call_handler(b,c);return d},parse:function(a,c){var d,e,f,g=[];for(d in a)if(f=a[d],null!==f)if(f!==b){switch(f.constructor){case Date:e="new Date("+f.valueOf()+")";break;case Object:e="{"+this.parse(f).join(",")+"}";break;case Array:e="["+this.parse(f,!0).join(",")+"]";break;case String:e='"'+f.replace(/"/g,'\\"')+'"';break;case RegExp:case Function:e=f.toString();break;default:e=f}g.push(c?e:d+":"+e)}else g.push(d+":undefined");else g.push(d+":null");return g},observer:function(){var a={};return{on:function(b,c){a[b]||(a[b]=[]),a[b].unshift(c)},off:function(b,c){if(a[b]){var d=a[b].indexOf(c);a[b].splice(d,1)}},emit:function(b,c){if(a[b])for(var d={type:b,detail:c,isCanceled:!1,cancelBubble:function(){this.isCanceled=!0}},e=a[b].length;e--;){if(d.isCanceled)return;a[b][e](d)}}}}()};"undefined"==typeof module?a.x10=c.init():module.exports=c.init()}(this);